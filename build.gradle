plugins {
  id "base"
}

task wrapper(type: Wrapper) {
  gradleVersion = "4.3.1"
  distributionType = "ALL"
}

["bash", "fish"].each { ext ->

  build.doLast {
    file("$projectDir/main.$ext").text =
        file("$projectDir/src".replaceAll("\\\\", "/"))
            .listFiles()
            .findAll { it.name.endsWith(".$ext") }
            .collect { it.text }
            .join("\n")
  }

  clean.doFirst {
    [".gradle", "main.$ext"]
        .each { delete "$projectDir/$it" }
  }
}
